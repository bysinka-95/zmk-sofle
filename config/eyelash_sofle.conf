# -----------------------------------------------------
# BLUETOOTH PERFORMANCE & STABILITY (MACOS OPTIMIZED)
# -----------------------------------------------------
CONFIG_ZMK_BLE_EXPERIMENTAL_FEATURES=y
CONFIG_BT_CTLR_TX_PWR_PLUS_8=y

# FORCE 1Mbps PHY:
# This provides significantly better signal range and stability through
# interference than the default 2Mbps, preventing "stutter".
CONFIG_BT_CTLR_PHY_2M=n

# AGGRESSIVE CONNECTION INTERVALS:
# Forces the keyboard to negotiate the fastest possible polling rate
# (7.5ms - 15ms) with the Mac.
CONFIG_BT_PERIPHERAL_PREF_MIN_INT=6
CONFIG_BT_PERIPHERAL_PREF_MAX_INT=12
CONFIG_BT_PERIPHERAL_PREF_LATENCY=0
CONFIG_BT_PERIPHERAL_PREF_TIMEOUT=400

# -----------------------------------------------------
# KEYBOARD SCANNING (LATENCY)
# -----------------------------------------------------
# Lower debounce to 3ms for competitive latency.
# If you get double-clicks, increase this to 5.
CONFIG_ZMK_KSCAN_DEBOUNCE_PRESS_MS=3
CONFIG_ZMK_KSCAN_DEBOUNCE_RELEASE_MS=3

# NKRO disabled for best Bluetooth compatibility
CONFIG_ZMK_HID_REPORT_TYPE_NKRO=n

# -----------------------------------------------------
# DISPLAY: STOCK / LIGHTWEIGHT
# -----------------------------------------------------
# We enable the display but use the BUILT-IN widgets.
# These are text-based and do not use heavy animations, keeping the CPU free.
CONFIG_ZMK_DISPLAY=y
CONFIG_ZMK_DISPLAY_STATUS_SCREEN_BUILT_IN=y
CONFIG_ZMK_DISPLAY_STATUS_SCREEN_CUSTOM=n

# Standard widgets
CONFIG_ZMK_WIDGET_BATTERY_STATUS=y
CONFIG_ZMK_WIDGET_OUTPUT_STATUS=y
CONFIG_ZMK_WIDGET_LAYER_STATUS=y

# Disable WPM (Words Per Minute)
# WPM triggers a screen refresh on every keystroke, which can increase
# latency during fast typing. Disabled for max performance.
CONFIG_ZMK_WIDGET_WPM_STATUS=n

# -----------------------------------------------------
# RGB UNDERGLOW
# -----------------------------------------------------
CONFIG_WS2812_STRIP=y
CONFIG_ZMK_RGB_UNDERGLOW=y
CONFIG_ZMK_RGB_UNDERGLOW_EXT_POWER=y
CONFIG_ZMK_RGB_UNDERGLOW_ON_START=y
CONFIG_ZMK_RGB_UNDERGLOW_BRT_MAX=90
CONFIG_ZMK_RGB_UNDERGLOW_AUTO_OFF_IDLE=y
CONFIG_ZMK_RGB_UNDERGLOW_AUTO_OFF_USB=y
CONFIG_ZMK_RGB_UNDERGLOW_HUE_START=160
CONFIG_ZMK_RGB_UNDERGLOW_EFF_START=3

# -----------------------------------------------------
# BACKLIGHT
# -----------------------------------------------------
CONFIG_ZMK_BACKLIGHT=y
CONFIG_ZMK_BACKLIGHT_BRT_START=100
CONFIG_ZMK_BACKLIGHT_ON_START=y
CONFIG_ZMK_BACKLIGHT_AUTO_OFF_IDLE=n

# -----------------------------------------------------
# INPUT PERIPHERALS
# -----------------------------------------------------
# Encoders
CONFIG_EC11=y
CONFIG_EC11_TRIGGER_GLOBAL_THREAD=y

# Mouse Keys
CONFIG_ZMK_POINTING=y

# -----------------------------------------------------
# POWER MANAGEMENT
# -----------------------------------------------------
# Sleep after 1 hour
CONFIG_ZMK_IDLE_SLEEP_TIMEOUT=3600000
CONFIG_ZMK_SLEEP=y
CONFIG_ZMK_PM_SOFT_OFF=y
CONFIG_ZMK_EXT_POWER=y

# -----------------------------------------------------
# HARDWARE
# -----------------------------------------------------
CONFIG_CLOCK_CONTROL_NRF_K32SRC_XTAL=y
CONFIG_CLOCK_CONTROL_NRF_K32SRC_30PPM=y
